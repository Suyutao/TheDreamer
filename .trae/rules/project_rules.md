### **项目说明书：The Dreamer App (v12)**

#### **1. 项目愿景 (Vision)**

**“The Dreamer”** 是一款专为高中生设计的、基于Apple生态的**学习分析与诊断工具**。

它不仅仅是一个简单的成绩记录App，其核心使命是通过**精细化的数据记录**和**专业的数据可视化**，帮助学生：
*   **看清趋势：** 直观地了解自己成绩的长期变化和波动。
*   **诊断问题：** 从宏观的科目强弱，下探到微观的题型、考法得失分情况，精准定位知识漏洞。
*   **量化目标：** 将升学梦想转化为可追踪、可分析的数据目标，并提供清晰的达成路径。
*   **激发动力：** 通过积极的反馈和清晰的进步展示，将枯燥的数字转化为激励人心的力量。

最终，我们旨在打造一个能陪伴高中生走过重要求学阶段的、既是工具又是伙伴的智能应用。

#### **2. 核心设计哲学 (Design Philosophy)**

*   **数据驱动，可视化优先：** 所有的功能设计都为最终的数据可视化服务。图表不是点缀，而是产品的核心体验。
*   **灵活与强大并存：** 提供从“只记总分”的极简模式，到“记录每一题”的深度分析模式。用户可以根据自己的需求和精力，自由选择录入的精细度。
*   **模板化与效率：** 通过“卷子模板”系统，将重复性的结构化录入工作降到最低，尤其针对结构固定的重要考试，实现一键套用，高效录入。
*   **原生体验，无缝生态：** 100%使用Apple原生框架（SwiftUI, SwiftData），不引入任何第三方依赖，确保最佳性能、稳定性，并为未来的iCloud跨设备无缝同步打下坚实基础。

#### **3. 功能蓝图 (Feature Blueprint)**

*   **OnBoarding:**
    *   一次性引导用户设置基础信息，包括选择模式（初期为“高考模式”）、选科、设置各科总分、填写班级/年级总人数、设定学期开始日期。
    *   **所有这些数据都将被视为核心业务数据，存入SwiftData。**

*   **数据模型 (基于SwiftData):**
    *   **科目 (Subject):** 数据的枢纽，关联模板和考试，并能**自动学习和汇总**其下所有出现过的“考法”和“题型”。
    *   **卷子模板 (PaperTemplate):** 可复用的试卷结构蓝图，包含一个**题目模板 (QuestionTemplate)** 列表。
    *   **题目模板 (QuestionTemplate):** 定义了题目的基本属性（题号、分值、题型、考法），是模板的“骨架”。
    *   **考试 (Exam):** 一次真实考试的记录实例。创建时可通过“深拷贝”卷子模板来快速生成其结构。
    *   **题目 (Question):** 考试实例中的具体题目，核心是记录了用户的**得分 (score)**。
    *   **练习 (Practice):** 一个轻量化的成绩记录系统，逻辑与考试类似，但管理上更侧重于按“练习组”分类。

*   **核心交互流程：**
    *   **创建模板:** 用户可以为不同科目创建常用的卷子模板，定义好每一道题的题号、分值、题型和考法。UI交互将采用**动态表单**，允许用户流畅地增删改题目。
    *   **添加考试/练习:** 用户可以选择从一个模板快速创建，也可以从零开始手动录入。录入过程支持从只填总分到细化每一题得分的多种粒度。
    *   **Dashboard (首页):** 核心的可视化界面，以卡片和可左右滑动的图表页形式，展示总分趋势、科目对比等关键信息。

*   **可视化方案 (Charts):**
    *   **MVP核心图表:**
        *   **折线图:** 展示分数随时间的变化趋势，可叠加“我的分数”、“班级均分”、“目标分数”等多条曲线。
        *   **柱状图:** 用于单次联考中，各科分数的横向对比。
        *   **得分占比叠层柱状图:** 以创新的视角，展示历次总分中，各科分数贡献的比例变化。
    *   **进阶图表 (Post-MVP):**
        *   **散点密度图:** 用于诊断不同分值、不同题型的得分效率，发现优势区间和失分重灾区。
        *   **热力图:** 用于分析特定题型/考法的长期能力变化趋势。

#### **4. 技术栈与开发规则 (Tech Stack & Rules)**

*   **框架与语言:** SwiftUI, SwiftData, Swift (均使用最新版)。
*   **目标平台:** Apple生态 (iOS, iPadOS, macOS)，目标SDK为 **OS 26**。
*   **禁止使用的APIs:**
    *   禁止使用`UIKit`/`AppKit`进行界面布局。
    *   禁止使用`CoreData`进行数据持久化。
    *   禁止使用`UserDefaults`存储核心业务数据（如选科、人数等）。`UserDefaults`仅用于存储非关键性的App行为偏好（如主题色）。
*   **代码注释:** [V13] 所有在最终产品代码中生成的注释，都应该是清晰、专业、面向未来的开发者的。为所有非显而易见的公共函数或方法提供清晰的注释（//），解释其功能、参数和返回值。[Vxxx]是我自己定的蓝图版本，我会手动通知你修改，请你不要私自修改。
*   **测试:** 使用`XCTest`进行单元测试，`XCUITest`进行UI测试。
*   **协作模式:** UI开发者可使用`@State`和占位符数据构建视图，完成后交由数据工程师适配`SwiftData`后端逻辑，实现高效并行开发。